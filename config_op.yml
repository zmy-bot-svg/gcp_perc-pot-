# ğŸš€ é’ˆå¯¹RTX 4090æœåŠ¡å™¨ä¼˜åŒ–çš„GCPNet+PotNeté…ç½®
project_name: "GCPNet_PotNet_4090_hyperopt"
net: "GCPNet"
output_dir: "./output_potnet_4090"
self_loop: True
n_neighbors: 12
debug: False

netAttributes:
  firstUpdateLayers: 4
  secondUpdateLayers: 4
  atom_input_features: 105
  edge_input_features: 50
  triplet_input_features: 40
  embedding_features: 64
  hidden_features: 128                 # åŸºå‡†å€¼ï¼Œä¼šè¢«è¶…å‚æ•°æœç´¢è¦†ç›–
  output_features: 1
  min_edge_distance: 0.0
  max_edge_distance: 8.0
  link: "identity"
  batch_size: 64                       # ä¿æŒåŸbatch_sizeï¼ŒPotNetä¸»è¦å½±å“é¢„å¤„ç†
  num_workers: 6
  dropout_rate: 0.1

# ğŸ†• PotNetç‰¹å®šå‚æ•°ï¼ˆä¼šè¢«è¶…å‚æœç´¢è¦†ç›–ï¼‰
potnet:
  enable: True
  eps: 1.0e-12                        # æ•°å€¼ç²¾åº¦
  parallel: False                     # æ˜¯å¦å¹¶è¡Œè®¡ç®—
  verbose: False                      # æ˜¯å¦è¾“å‡ºè°ƒè¯•ä¿¡æ¯

hyperParameters:
  lr: 0.001
  optimizer: "AdamW"
  optimizer_args:
    weight_decay: 5.0e-5
  scheduler: "ReduceLROnPlateau"
  scheduler_args:
    mode: "min"
    factor: 0.5
    patience: 10                      # ğŸ”§ å¢åŠ patienceï¼ŒPotNetæ”¶æ•›å¯èƒ½æ›´æ…¢
    min_lr: 1.0e-6
    threshold: 0.0002
  seed: 666
  epochs: 50                          # ğŸ”§ å¢åŠ epochsï¼ŒPotNetå¯èƒ½éœ€è¦æ›´å¤šè®­ç»ƒ
  patience: 20                        # ğŸ”§ å¢åŠ early stopping patience

data:
  points: all
  dataset_path: './data'
  dataset_name: 'jarvis_fe_15k'
  target_name: 'formation_energy_peratom'
  pin_memory: True
  num_folds: 5

predict:
  model_path: 'model.pt'
  output_path: 'output.csv'

visualize_args:
  perplexity: 50
  early_exaggeration: 12
  learning_rate: 300
  n_iter: 5000
  verbose: 1
  random_state: 42

# ğŸš€ ä¼˜åŒ–åçš„Optunaè¶…å‚æ•°æœç´¢é…ç½®
optuna:
  n_trials: 80                        # ğŸ”§ å‡å°‘è¯•éªŒæ¬¡æ•°ï¼Œå› ä¸ºæ¯æ¬¡è¯•éªŒæ›´æ…¢
  study_name: "GCPNet_PotNet_4090_hyperopt"
  direction: "minimize"               # æœ€å°åŒ–MAE
  timeout: null                       # ä¸è®¾ç½®è¶…æ—¶
  
  # ğŸ”§ æœç´¢ç©ºé—´é…ç½®
  search_space:
    # åŸºç¡€GCPNetå‚æ•°
    lr:
      type: "float"
      low: 0.0003
      high: 0.003                     # ğŸ”§ é™ä½å­¦ä¹ ç‡èŒƒå›´ï¼ŒPotNetæ›´æ•æ„Ÿ
      log: true
    dropout_rate:
      type: "float" 
      low: 0.05
      high: 0.25                      # ğŸ”§ é™ä½dropoutèŒƒå›´
    weight_decay:
      type: "float"
      low: 1.0e-6
      high: 5.0e-4                    # ğŸ”§ è°ƒæ•´weight_decayèŒƒå›´
      log: true
    batch_size:
      type: "categorical"
      choices: [48, 64, 96, 128]           # æ¢å¤æ›´å¤§çš„batch_sizeé€‰é¡¹
    hidden_features:
      type: "categorical" 
      choices: [96, 128, 160, 192]         # ğŸ”§ å‡å°‘æ¨¡å‹å¤§å°é€‰é¡¹
    
    # ğŸ†• PotNetç‰¹å®šå‚æ•°
    coulomb_param:
      type: "float"
      low: 0.5
      high: 2.0
    london_param:
      type: "float"
      low: 0.5
      high: 2.0
    pauli_param:
      type: "float"
      low: 1.0
      high: 5.0
    R_grid:
      type: "int"
      low: 3
      high: 6                         # ğŸ”§ é™åˆ¶R_gridé¿å…è®¡ç®—çˆ†ç‚¸
  
  # ğŸ”§ è°ƒæ•´å‰ªæé…ç½®ï¼ˆå¹³è¡¡æ•ˆç‡ä¸æ¢ç´¢ï¼‰
  pruner:
    enable: true
    type: "MedianPruner"
    n_startup_trials: 5               # ğŸ”§ 5ä¸ªtrialåå¼€å§‹å‰ªæ
    n_warmup_steps: 6                 # ğŸ”§ æ¯ä¸ªtrialå‰5ä¸ªepochä¸å‰ªæ
    interval_steps: 2                 # æ¯2ä¸ªepochæ£€æŸ¥ä¸€æ¬¡
  
  # ğŸ”§ é‡‡æ ·å™¨é…ç½®
  sampler:
    enable: true
    type: "TPESampler"
    params:
      n_startup_trials: 10            # ğŸ”§ å¢åŠ startup trials
      
  # ğŸ”§ ç»­ä¼ é…ç½®
  resume:
    enable: true
    auto_detect: true
    
wandb:
  log_enable: False
  sweep_count: 80
  entity: "1548532425-null"

# ğŸ”§ ç³»ç»Ÿä¼˜åŒ–é…ç½®
system:
  gpu:
    memory_fraction: 0.85             # ğŸ”§ é™ä½GPUå†…å­˜ä½¿ç”¨
    allow_growth: true
  cpu:
    max_workers_ratio: 0.4            # ğŸ”§ é™ä½CPUä½¿ç”¨
  monitoring:
    log_interval: 5                   # ğŸ”§ æ›´é¢‘ç¹çš„ç›‘æ§
    save_interval: 3